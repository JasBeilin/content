category: IT Services
commonfields:
  id: Azure SQL Management
  version: -1
configuration:
- defaultvalue: 8f9010bb-4efe-4cfa-a197-98a2694b7e0c
  display: Application ID
  hidden: false
  name: app_id
  required: true
  type: 0
- display: Subscription ID
  hidden: false
  name: subscription_id
  required: true
  type: 0
- display: Resource Group Name
  hidden: false
  name: resource_group_name
  required: true
  type: 0
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: Microsoft Azure SQL Database is a managed cloud database provided as
  part of Microsoft Azure.
display: Azure SQL Management (Beta)
name: Azure SQL Management
script:
  commands:
  - deprecated: false
    description: Run this command to start the authorization process and follow the
      instructions in the command results.
    execution: false
    name: azure-sql-auth-start
  - deprecated: false
    description: Run this command to complete the authorization process. Should be
      used after running the azure-sql-auth-start command.
    execution: false
    name: azure-sql-auth-complete
  - deprecated: false
    description: Run this command if for some reason you need to rerun the authentication
      process.
    execution: false
    name: azure-sql-auth-reset
  - deprecated: false
    description: Tests the connectivity to the Azure SQL Management.
    execution: false
    name: azure-sql-auth-test
  - arguments:
    - default: false
      defaultValue: '50'
      description: (Int) The maximum number of servers returned to the War Room.
      isArray: false
      name: limit
      required: false
      secret: false
    - default: false
      defaultValue: '0'
      description: '(Int) Offset in the data set. '
      isArray: false
      name: offset
      required: false
      secret: false
    deprecated: false
    description: List of all servers.
    execution: false
    name: azure-sql-servers-list
    outputs:
    - contextPath: AzureSQL.Server
      description: Servers list
      type: Unknown
    - contextPath: AzureSQL.Server.kind
      description: Kind of server.
      type: String
    - contextPath: AzureSQL.Server.location
      description: Server location.
      type: String
    - contextPath: AzureSQL.Server.tags
      description: Server Tags.
      type: Unknown
    - contextPath: AzureSQL.Server.id
      description: Server id.
      type: String
    - contextPath: AzureSQL.Server.name
      description: Server name.
      type: String
    - contextPath: AzureSQL.Server.type
      description: Server type.
      type: String
    - contextPath: AzureSQL.Server.administratorLogin
      description: Username of server administrator.
      type: String
    - contextPath: AzureSQL.Server.version
      description: Server version.
      type: String
    - contextPath: AzureSQL.Server.state
      description: Server state.
      type: String
    - contextPath: AzureSQL.Server.fullyQualifiedDomainName
      description: Servers fully qualified domain name.
      type: Unknown
    - contextPath: AzureSQL.Server.privateEndpointConnections
      description: List of servers private endpoint connections.
      type: Unknown
    - contextPath: AzureSQL.Server.publicNetworkAccess
      description: Servers public endpoint access. The value is 'Enabled' or 'Disabled'.
      type: String
  - arguments:
    - default: false
      description: Server name.
      isArray: false
      name: server_name
      required: true
      secret: false
    - default: false
      defaultValue: '50'
      description: (Int) The maximum number of DataBases returned to the War Room.
      isArray: false
      name: limit
      required: false
      secret: false
    - default: false
      defaultValue: '0'
      description: '(Int) Offset in the data set. '
      isArray: false
      name: offset
      required: false
      secret: false
    deprecated: false
    description: List of all DataBases for server.
    execution: false
    name: azure-sql-db-list
    outputs:
    - contextPath: AzureSQL.DB
      description: All DB related to the server.
      type: Unknown
    - contextPath: AzureSQL.DB.kind
      description: Kind of database.
      type: String
    - contextPath: AzureSQL.DB.location
      description: Database location.
      type: String
    - contextPath: AzureSQL.DB.id
      description: Database id.
      type: String
    - contextPath: AzureSQL.DB.name
      description: Database name.
      type: String
    - contextPath: AzureSQL.DB.type
      description: Database type.
      type: String
    - contextPath: AzureSQL.DB.managedBy
      description: Recource that manages database.
      type: String
    - contextPath: AzureSQL.DB.sku
      description: Database SKU.
      type: Unknown
    - contextPath: AzureSQL.DB.catalogCollation
      description: Collation of catalog.
      type: String
    - contextPath: AzureSQL.DB.collation
      description: Database collation.
      type: String
    - contextPath: AzureSQL.DB.creationDate
      description: Creation date of the database, in ISO format.
      type: String
    - contextPath: AzureSQL.DB.currentServiceObjectiveName
      description: Database's current service level objective name.
      type: String
    - contextPath: AzureSQL.DB.currentSku
      description: Name, Tier and capacity of the SKU.
      type: Unknown
    - contextPath: AzureSQL.DB.databaseID
      description: Database ID.
      type: String
    - contextPath: AzureSQL.DB.defaultSecondaryLocation
      description: Default secondarylocation of the database.
      type: String
    - contextPath: AzureSQL.DB.maxSizeBytes
      description: The max size of the database in bytes.
      type: Number
    - contextPath: AzureSQL.DB.readReplicaCount
      description: The number of readonly secondary replicas of the database.
      type: Number
    - contextPath: AzureSQL.DB.readScale
      description: The state of read-only routing.  "Enabled" or "Disabled".
      type: String
    - contextPath: AzureSQL.DB.requestedServiceObjectiveName
      description: 'Database''s requested service objective name. '
      type: String
    - contextPath: AzureSQL.DB.status
      description: Database status.
      type: String
    - contextPath: AzureSQL.DB.storageAccountType
      description: Database storage account type.
      type: String
    - contextPath: AzureSQL.DB.zoneRedundant
      description: Is the database zone redundan.
      type: Boolean
  - arguments:
    - default: false
      description: Server name.
      isArray: false
      name: server_name
      required: true
      secret: false
    - default: false
      description: Database name.
      isArray: false
      name: db_name
      required: true
      secret: false
    - default: false
      defaultValue: '50'
      description: (Int) The maximum number of DataBases audit policies returned to
        the War Room.
      isArray: false
      name: limit
      required: false
      secret: false
    - default: false
      defaultValue: '0'
      description: (Int) Offset in the data set.
      isArray: false
      name: offset
      required: false
      secret: false
    deprecated: false
    description: Auditing settings of a database.
    execution: false
    name: azure-sql-db-audit-policy-list
    outputs:
    - contextPath: AzureSQL.DBAuditPolicy
      description: All DB related to the server.
      type: Unknown
    - contextPath: AzureSQL.DBAuditPolicy.kind
      description: Kind of audit policy.
      type: String
    - contextPath: AzureSQL.DBAuditPolicy.id
      description: Audit policy id.
      type: String
    - contextPath: AzureSQL.DBAuditPolicy.name
      description: Audit policy name.
      type: String
    - contextPath: AzureSQL.DBAuditPolicy.type
      description: Database type.
      type: String
    - contextPath: AzureSQL.DBAuditPolicy.isAzureMonitorTargetEnabled
      description: Whether audit events are sent to Azure Monitor. the value is "
        Enabled" or "Disabled".
      type: Boolean
    - contextPath: AzureSQL.DBAuditPolicy.retentionDays
      description: Number of days to keep in the audit logs in the storage account.
      type: Number
    - contextPath: AzureSQL.DBAuditPolicy.state
      description: Policy state.
      type: String
    - contextPath: AzureSQL.DBAuditPolicy.storageAccountSubscriptionId
      description: storage subscription Id.
      type: String
    - contextPath: AzureSQL.DBAuditPolicy.databaseName
      description: The name of database, that audit policy related to.
      type: String
    - contextPath: AzureSQL.DBAuditPolicy.serverName
      description: The name of server, that audit policy related to.
      type: String
  - arguments:
    - default: false
      description: Server name.
      isArray: false
      name: server_name
      required: true
      secret: false
    - default: false
      description: Database name.
      isArray: false
      name: db_name
      required: true
      secret: false
    deprecated: false
    description: Threat detection policy of a database.
    execution: false
    name: azure-sql-db-threat-policy-get
    outputs:
    - contextPath: AzureSQL.DBThreatPolicy
      description: All Threat Policy related to the database.
      type: Unknown
    - contextPath: AzureSQL.DBThreatPolicy.kind
      description: Kind of Threat Policy.
      type: String
    - contextPath: AzureSQL.DBThreatPolicy.location
      description: Threat Policy location.
      type: String
    - contextPath: AzureSQL.DBThreatPolicy.id
      description: Threat Policy id.
      type: String
    - contextPath: AzureSQL.DBThreatPolicy.name
      description: Threat Policy name.
      type: String
    - contextPath: AzureSQL.DBThreatPolicy.type
      description: Threat Policy type.
      type: String
    - contextPath: AzureSQL.DBThreatPolicy.state
      description: Policy state.
      type: String
    - contextPath: AzureSQL.DBThreatPolicy.creationTime
      description: Policy creation Time.
      type: String
    - contextPath: AzureSQL.DBThreatPolicy.retentionDays
      description: Number of days to keep in the Threat Detection audit logs.
      type: Number
    - contextPath: AzureSQL.DBThreatPolicy.storageAccountAccessKey
      description: Specifies the identifier key of the Threat Detection audit storage
        account.
      type: String
    - contextPath: AzureSQL.DBThreatPolicy.storageEndpoint
      description: Threat Detection audit storage account.
      type: String
    - contextPath: AzureSQL.DBThreatPolicy.emailAccountAdmins
      description: Email account administrators that alert is sent to.
      type: Boolean
    - contextPath: AzureSQL.DBThreatPolicy.emailAddresses
      description: list of e-mail addresses to which the alert is sent.
      type: String
    - contextPath: AzureSQL.DBThreatPolicy.disabledAlerts
      description: list of alerts that are disabled, or empty string to disable no
        alerts.
      type: String
    - contextPath: AzureSQL.DBThreatPolicy.useServerDefault
      description: whether to use the default server policy.
      type: Unknown
    - contextPath: AzureSQL.DBThreatPolicy.databaseName
      description: The name of database, that threat policy related to.
      type: String
    - contextPath: AzureSQL.DBThreatPolicy.serverName
      description: The name of server, that threat policy related to.
      type: String
  - arguments:
    - default: false
      description: Server name.
      isArray: false
      name: server_name
      required: true
      secret: false
    - default: false
      description: Database name.
      isArray: false
      name: db_name
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Set state 'Enable' or 'Disable'. When state is Enabled, storage_endpoint
        or is_azure_monitor_target_enabled are required.
      isArray: false
      name: state
      predefined:
      - Enabled
      - Disabled
      required: true
      secret: false
    - default: false
      description: Comma-separated Actions-Groups and Actions to audit. For all Possible
        values visit integration documentation at https://xsoar.pan.dev/.
      isArray: true
      name: audit_actions_groups
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Is audit events are sent to Azure Monitor.
      isArray: false
      name: is_azure_monitor_target_enabled
      predefined:
      - 'true'
      - 'false'
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Is storage Account Access Key value is the storage's secondary
        key.
      isArray: false
      name: is_storage_secondary_key_in_use
      predefined:
      - 'true'
      - 'false'
      required: false
      secret: false
    - default: false
      description: Time in milliseconds that can elapse before audit actions are forced
        to be processed. The default minimum value is 1000 (1 second).
      isArray: false
      name: queue_delay_ms
      required: false
      secret: false
    - default: false
      description: Number of days to keep the policy in the audit logs.
      isArray: false
      name: retention_days
      required: false
      secret: false
    - default: false
      description: Identifier key of the auditing storage account.
      isArray: false
      name: storage_account_access_key
      required: false
      secret: false
    - default: false
      description: storage subscription Id
      isArray: false
      name: storage_account_subscription_id
      required: false
      secret: false
    - default: false
      description: Storage endpoint. If state is Enabled, storageEndpoint or isAzureMonitorTargetEnabled
        is required.
      isArray: false
      name: storage_endpoint
      required: false
      secret: false
    deprecated: false
    description: Create or update database's auditing policy.
    execution: false
    name: azure-sql-db-audit-policy-create-update
    outputs:
    - contextPath: AzureSQL.DBAuditPolicy.kind
      description: Kind of audit policy.
      type: String
    - contextPath: AzureSQL.DBAuditPolicy.id
      description: Audit policy id.
      type: String
    - contextPath: AzureSQL.DBAuditPolicy.name
      description: Audit policy name.
      type: String
    - contextPath: AzureSQL.DBAuditPolicy.type
      description: Database type.
      type: String
    - contextPath: AzureSQL.DBAuditPolicy.isAzureMonitorTargetEnabled
      description: Whether audit events are sent to Azure Monitor. the value is "
        Enabled" or "Disabled".
      type: Boolean
    - contextPath: AzureSQL.DBAuditPolicy.retentionDays
      description: Number of days to keep in the audit logs in the storage account.
      type: Number
    - contextPath: AzureSQL.DBAuditPolicy.state
      description: Policy state
      type: String
    - contextPath: AzureSQL.DBAuditPolicy.storageAccountSubscriptionId
      description: storage subscription Id.
      type: String
    - contextPath: AzureSQL.DBAuditPolicy.auditActionsAndGroups
      description: audit Actions And Groups to audit.
      type: Unknown
    - contextPath: AzureSQL.DBAuditPolicy.isStorageSecondaryKeyInUse
      description: Is storageAccountAccessKey value is the storage's secondary key.
      type: String
    - contextPath: AzureSQL.DBAuditPolicy.queueDelayMs
      description: Time in milliseconds that can elapse before audit actions are forced
        to be processed.
      type: String
    - contextPath: AzureSQL.DBAuditPolicy.storageAccountAccessKey
      description: identifier key of the auditing storage account.
      type: String
    - contextPath: AzureSQL.DBAuditPolicy.storageEndpoint
      description: Storage endpoint.
      type: String
    - contextPath: AzureSQL.DBAuditPolicy.databaseName
      description: The name of database, that audit policy related to.
      type: String
    - contextPath: AzureSQL.DBAuditPolicy.serverName
      description: The name of server, that audit policy related to.
      type: String
  - arguments:
    - default: false
      description: Server name
      isArray: false
      name: server_name
      required: true
      secret: false
    - default: false
      description: Database name
      isArray: false
      name: db_name
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: set state 'Enable' or 'Disable'
      isArray: false
      name: state
      predefined:
      - Enabled
      - Disabled
      required: true
      secret: false
    - default: false
      description: Number of days to keep the policy in the audit logs.
      isArray: false
      name: retention_days
      required: false
      secret: false
    - default: false
      description: The identifier key of the Threat Detection audit storage account.
      isArray: false
      name: storage_account_access_key
      required: false
      secret: false
    - default: false
      description: Storage endpoint. If state is Enabled, storageEndpoint or isAzureMonitorTargetEnabled
        is required.
      isArray: false
      name: storage_endpoint
      required: false
      secret: false
    - default: false
      description: 'Comma-separated list of alerts that are disabled. Possible values:
        None, Sql_Injection, Sql_Injection_Vulnerability, Access_Anomaly, Data_Exfiltration,
        Unsafe_Action'
      isArray: true
      name: disabled_alerts
      required: false
      secret: false
    - default: false
      description: Comma-separated list of e-mail addresses to which the alert is
        sent.
      isArray: true
      name: email_addresses
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: The alert is sent to the account administrators.
      isArray: false
      name: email_account_admins
      predefined:
      - 'true'
      - 'false'
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Whether to use the default server policy or not.
      isArray: false
      name: use_server_default
      predefined:
      - Enabled
      - Disabled
      required: false
      secret: false
    deprecated: false
    description: Create or update database's threat detection policy.
    execution: false
    name: azure-sql-db-threat-policy-create-update
    outputs:
    - contextPath: AzureSQL.DBThreatPolicy.kind
      description: Kind of Threat Policy.
      type: String
    - contextPath: AzureSQL.DBThreatPolicy.location
      description: Threat Policy location.
      type: String
    - contextPath: AzureSQL.DBThreatPolicy.id
      description: Threat Policy id
      type: String
    - contextPath: AzureSQL.DBThreatPolicy.name
      description: Threat Policy name
      type: String
    - contextPath: AzureSQL.DBThreatPolicy.type
      description: Threat Policy type.
      type: String
    - contextPath: AzureSQL.DBThreatPolicy.state
      description: Policy state
      type: String
    - contextPath: AzureSQL.DBThreatPolicy.creationTime
      description: Policy creation Time
      type: String
    - contextPath: AzureSQL.DBThreatPolicy.retentionDays
      description: Number of days to keep in the Threat Detection audit logs.
      type: Number
    - contextPath: AzureSQL.DBThreatPolicy.storageAccountAccessKey
      description: The identifier key of the Threat Detection audit storage account.
      type: String
    - contextPath: AzureSQL.DBThreatPolicy.storageEndpoint
      description: Threat Detection audit storage account.
      type: String
    - contextPath: AzureSQL.DBThreatPolicy.emailAccountAdmins
      description: Email account administrators that alert is sent to.
      type: Boolean
    - contextPath: AzureSQL.DBThreatPolicy.emailAddresses
      description: list of e-mail addresses to which the alert is sent.
      type: String
    - contextPath: AzureSQL.DBThreatPolicy.disabledAlerts
      description: list of alerts that are disabled, or empty string to disable no
        alerts.
      type: String
    - contextPath: AzureSQL.DBThreatPolicy.useServerDefault
      description: whether to use the default server policy.
      type: Unknown
    - contextPath: AzureSQL.DBThreatPolicy.databaseName
      description: The name of database, that threat policy related to.
      type: String
    - contextPath: AzureSQL.DBThreatPolicy.serverName
      description: The name of server, that threat policy related to.
      type: String
  dockerimage: demisto/crypto:1.0.0.14297
  feed: false
  isfetch: false
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  subtype: python3
  type: python
tests:
- Azure SQL - Test
fromversion: 5.0.0
